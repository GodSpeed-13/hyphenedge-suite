import React, { useEffect, useState } from "react";

interface AnimatedTriangleProps {
  onAnimationComplete?: () => void;
}

const AnimatedTriangle: React.FC<AnimatedTriangleProps> = ({ onAnimationComplete }) => {
  const [showLogo, setShowLogo] = useState(false);
  const [iconStage, setIconStage] = useState(0);
  const [rotate, setRotate] = useState(0);

  const sequence = [0, 1200, 2400, 3600]; // icon timings
  const loopDelay = 7000; // delay after each loop in ms

  // Trigger triangle + brand text animation once
  useEffect(() => {
    const timer = setTimeout(() => {
      setShowLogo(true);
      onAnimationComplete?.();
    }, sequence[sequence.length - 1] + 600);
    return () => clearTimeout(timer);
  }, [onAnimationComplete]);

  // Rotate icons continuously
  useEffect(() => {
    const rotateInterval = setInterval(() => setRotate((r) => (r + 15) % 360), 50);
    return () => clearInterval(rotateInterval);
  }, []);

  // Loop icons with fade effect
  useEffect(() => {
    let currentIndex = 0;
    
    const intervalId = setInterval(() => {
      setIconStage(currentIndex);
      currentIndex = (currentIndex + 1) % sequence.length;
    }, (sequence[1] - sequence[0]));

    return () => clearInterval(intervalId);
  }, []);

  // Common props for icons
  const iconStyle = (stage: number) => ({
    opacity: iconStage === stage ? 1 : 0,
    transition: "opacity 0.4s ease-in-out",
    transform: `rotate(${rotate}, 175, 145)`,
    filter: "url(#glow)",
  });

  return (
    <div className={`relative transition-all duration-1000 ${showLogo ? "transform translate-x-[-140px]" : ""}`}>
      <svg width="400" height="300" viewBox="0 0 350 250" className="drop-shadow-2xl" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <defs>
          <linearGradient id="triangleGradient" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stopColor="#0047FF" />
            <stop offset="100%" stopColor="#00CFFF" />
          </linearGradient>
          <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
            <feGaussianBlur in="SourceGraphic" stdDeviation={6} result="blur" />
            <feMerge>
              <feMergeNode in="blur" />
              <feMergeNode in="SourceGraphic" />
            </feMerge>
          </filter>
        </defs>

        {/* Triangle */}
{/*         <path d="M175 60 L250 190 L100 190 Z" fill="url(#triangleGradient)" filter="url(#glow)" /> */}
          <path
          d="M175 60 L250 190 L100 190 Z"
          fill="url(#triangleGradient)"
          stroke="url(#triangleGradient)"
          strokeWidth={5}        // thickness of the edge to create smooth corners
          strokeLinejoin="round" // rounds the corners
          filter="url(#glow)"
        />

        {/* AI Brain */}
        <g style={iconStyle(0)}>
          <path
            d="M175 135 c-5,-5 -15,-5 -15,5 c0,5 5,10 10,10 c5,0 10,-5 10,-10 c0,-5 -2,-7 -5,-5z"
            fill="#FFD700"
          />
          <circle cx="175" cy="140" r={2} fill="#FFAA00" />
        </g>

        {/* Security Lock */}
        <g style={iconStyle(1)} transform="translate(150, 120) scale(0.02, -0.02)" fill="#03fcfd" stroke="none">
          <path d="M1410 2793 c-19 -9 -48 -22 -65 -29 -16 -7 -84 -35 -150 -63 -66 -27
          -250 -104 -409 -171 -158 -66 -301 -129 -316 -140 -63 -45 -91 -139 -101 -339
          -46 -882 292 -1527 954 -1824 103 -46 195 -59 264 -37 112 36 346 166 449 251
          37 31 192 186 221 221 122 150 231 366 294 582 30 103 31 106 48 196 42 216
          49 608 15 810 -15 91 -70 148 -186 194 -72 29 -144 59 -183 76 -11 5 -81 34
          -155 65 -74 31 -144 60 -155 65 -35 15 -87 37 -238 99 -162 67 -219 75 -287
          44z m232 -40 c46 -19 102 -42 126 -51 23 -9 42 -20 42 -24 0 -4 7 -8 15 -8 9
          0 102 -36 208 -81 106 -45 242 -101 302 -126 61 -25 130 -56 155 -69 101 -55
          122 -140 122 -494 0 -233 -10 -350 -46 -515 -30 -136 -99 -336 -145 -418 -11
          -20 -20 -38 -19 -40 5 -7 -105 -178 -162 -251 -16 -21 -203 -206 -232 -231 -9
          -7 -29 -22 -45 -32 -15 -10 -34 -23 -41 -30 -7 -7 -20 -13 -28 -13 -8 0 -14
          -4 -14 -8 0 -5 -26 -22 -57 -38 -32 -16 -64 -33 -72 -38 -7 -6 -18 -11 -25
          -12 -6 -1 -38 -14 -71 -30 -69 -32 -74 -34 -137 -41 -60 -6 -152 23 -268 85
          -47 25 -98 52 -114 60 -98 50 -355 280 -340 304 4 7 3 8 -4 4 -12 -7 -78 71
          -119 143 -15 25 -31 49 -36 52 -6 4 -7 14 -4 24 4 9 3 14 -2 11 -5 -3 -15 4
          -23 17 -24 36 -105 229 -113 267 -4 19 -11 40 -15 45 -13 16 -58 210 -77 330
          -22 137 -24 537 -4 660 12 78 51 165 72 165 6 0 7 -6 3 -12 -4 -8 -3 -10 2 -5
          5 5 9 13 9 18 0 6 11 17 25 25 34 19 596 253 640 266 19 6 37 13 40 17 6 8
          245 107 275 114 36 9 93 -4 177 -40z"/>
          <path d="M1335 2595 c-82 -34 -166 -69 -185 -78 -76 -35 -322 -137 -331 -137
          -4 0 -25 -9 -46 -19 -21 -11 -74 -34 -117 -52 -108 -44 -113 -50 -121 -156 -4
          -48 -9 -97 -11 -108 -2 -11 -4 -83 -4 -160 -1 -264 38 -503 120 -725 29 -79
          143 -309 159 -320 4 -3 28 -32 53 -65 25 -33 86 -99 135 -146 83 -80 125 -113
          207 -163 17 -10 33 -21 36 -25 5 -7 159 -79 224 -106 36 -14 44 -14 90 1 57
          19 239 106 263 125 8 7 23 18 33 24 130 77 341 295 402 415 7 14 23 41 35 60
          64 100 147 349 179 535 31 178 39 369 25 555 -17 220 -12 210 -134 261 -56 24
          -107 46 -112 50 -6 4 -46 21 -90 37 -121 46 -298 121 -309 132 -6 6 -16 10
          -24 10 -7 0 -78 27 -158 60 -79 33 -150 60 -157 59 -6 -1 -79 -29 -162 -64z
          m315 -10 c74 -31 144 -60 155 -65 11 -5 97 -41 190 -80 94 -39 179 -75 190
          -80 11 -5 36 -15 55 -23 168 -69 192 -82 200 -103 22 -57 33 -416 18 -570 -61
          -616 -345 -1051 -833 -1275 -109 -50 -132 -49 -255 8 -133 62 -153 74 -258
          152 -333 245 -534 653 -570 1156 -12 172 -4 419 16 514 l8 35 319 134 c176 73
          381 160 455 192 74 32 144 59 155 59 11 1 81 -24 155 -54z"/>
          <path d="M1460 2554 c-19 -9 -213 -90 -430 -180 -217 -91 -399 -169 -403 -173
          -10 -10 -22 -179 -22 -316 0 -160 11 -280 40 -430 17 -89 60 -230 96 -314 135
          -316 343 -534 651 -681 l106 -51 59 26 c179 80 299 159 414 274 99 99 129 137
          196 246 81 131 158 332 189 488 32 169 39 244 39 442 0 140 -9 314 -17 320 -2
          1 -136 57 -298 124 -162 68 -304 127 -315 131 -145 62 -260 110 -264 110 -4
          -1 -22 -8 -41 -16z m64 -10 c9 -3 13 -11 9 -17 -4 -6 -1 -7 6 -2 7 4 27 0 44
          -8 18 -9 106 -46 197 -82 91 -37 176 -73 190 -81 14 -7 81 -35 150 -63 181
          -72 191 -76 183 -86 -5 -4 -2 -5 4 -1 24 13 50 -12 58 -56 11 -61 14 -422 4
          -493 -17 -124 -20 -142 -41 -235 -24 -110 -75 -262 -92 -272 -6 -4 -8 -8 -3
          -8 11 0 -88 -187 -136 -255 -55 -79 -208 -231 -283 -283 -76 -53 -266 -150
          -302 -155 -15 -2 -49 5 -77 17 -52 21 -236 122 -245 134 -3 4 -23 20 -45 36
          -64 48 -197 184 -190 196 4 6 2 9 -3 8 -11 -4 -62 55 -62 71 0 6 -4 11 -8 11
          -16 0 -118 203 -156 308 -47 131 -70 239 -95 442 -11 93 -13 330 -2 429 9 86
          27 119 59 106 7 -2 11 -1 8 3 -2 4 66 36 152 71 87 35 171 70 187 78 60 29
          321 136 355 145 19 6 37 13 40 17 7 9 52 29 67 30 6 1 18 -2 27 -5z"/>
          <path d="M1414 2151 c-42 -11 -136 -62 -154 -85 -77 -99 -98 -156 -101 -278
          -2 -79 -3 -85 -36 -122 -69 -76 -73 -95 -73 -347 0 -248 4 -268 60 -333 17
          -18 51 -44 76 -55 43 -21 61 -22 309 -22 144 -1 273 2 286 6 68 19 121 61 152
          120 19 37 20 56 19 273 -2 255 -8 291 -54 341 -16 17 -27 35 -24 40 3 5 -1 8
          -10 7 -13 -1 -16 11 -16 69 1 190 -81 322 -233 376 -55 19 -142 24 -201 10z
          m161 -15 c90 -17 180 -92 223 -184 21 -47 26 -76 30 -165 4 -94 7 -109 24
          -118 11 -6 33 -31 49 -57 l29 -46 0 -245 c0 -236 -1 -248 -23 -286 -12 -21
          -42 -53 -65 -70 l-44 -30 -298 0 -298 0 -43 30 c-24 17 -52 49 -65 75 -22 43
          -23 55 -24 280 l0 235 29 50 c16 28 41 57 55 64 25 14 26 17 26 115 0 124 18
          180 79 248 83 93 189 128 316 104z"/>
          <path d="M1415 2059 c-111 -42 -162 -120 -172 -262 l-6 -87 262 0 261 0 0 68
          c0 102 -23 166 -78 221 -72 71 -176 95 -267 60z m195 -29 c24 -12 38 -25 34
          -32 -4 -6 -3 -8 2 -5 15 9 28 -3 59 -53 24 -37 28 -57 31 -127 l3 -83 -241 0
          -241 0 5 78 c6 76 25 125 67 176 18 21 83 57 121 68 40 11 115 1 160 -22z"/>
          <path d="M1202 1619 c-59 -38 -62 -54 -62 -301 0 -327 -11 -316 332 -321 275
          -4 316 1 357 48 38 44 44 90 39 320 -3 171 -4 182 -27 214 -41 57 -62 61 -348
          61 -245 0 -260 -1 -291 -21z m573 -10 c16 -8 38 -27 49 -42 20 -27 21 -41 20
          -248 0 -314 17 -300 -348 -302 -353 -2 -336 -16 -338 295 -1 170 2 219 14 243
          8 17 20 29 26 28 7 -2 11 2 10 9 -6 27 76 35 308 33 172 -2 238 -6 259 -16z"/>
          <path d="M1443 1515 c-41 -18 -73 -69 -73 -118 0 -45 11 -70 54 -116 17 -19
          25 -30 17 -26 -10 6 -12 4 -5 -6 5 -8 9 -34 10 -58 2 -48 21 -71 60 -71 33 0
          45 22 46 88 1 55 4 61 35 82 21 14 36 36 43 59 13 48 13 54 -6 100 -12 30 -26
          45 -58 61 -49 23 -78 25 -123 5z m112 -21 c85 -40 80 -182 -7 -210 -15 -4 -18
          -16 -18 -75 l0 -70 -27 3 c-27 3 -28 5 -31 70 -3 63 -5 69 -31 83 -16 8 -36
          31 -46 51 -22 47 -8 101 36 138 35 30 76 33 124 10z"/>
          <path d="M1466 1424 c-21 -21 -20 -40 4 -64 24 -24 29 -24 58 -4 24 17 29 53
          10 72 -17 17 -54 15 -72 -4z m58 -20 c8 -21 -1 -34 -24 -34 -22 0 -34 15 -26
          35 7 20 42 19 50 -1z"/>
          <path d="M1135 1891 c-3 -5 -2 -12 3 -15 5 -3 9 1 9 9 0 17 -3 19 -12 6z"/>
          <path d="M708 2353 c7 -3 16 -2 19 1 4 3 -2 6 -13 5 -11 0 -14 -3 -6 -6z"/>
          <path d="M495 2110 c3 -5 8 -10 11 -10 2 0 4 5 4 10 0 6 -5 10 -11 10 -5 0 -7
          -4 -4 -10z"/>
          <path d="M502 2060 c0 -19 2 -27 5 -17 2 9 2 25 0 35 -3 9 -5 1 -5 -18z"/>
          <path d="M501 1684 c0 -11 3 -14 6 -6 3 7 2 16 -1 19 -3 4 -6 -2 -5 -13z"/>
          <path d="M521 1514 c0 -11 3 -14 6 -6 3 7 2 16 -1 19 -3 4 -6 -2 -5 -13z"/>
          <path d="M161 1894 c0 -11 3 -14 6 -6 3 7 2 16 -1 19 -3 4 -6 -2 -5 -13z"/>
          </g>

        {/* Gear / Automation */}
        <g style={iconStyle(2)}>
          <circle cx="175" cy="145" r={5} stroke="#FF69B4" strokeWidth={2} fill="none" />
          <line x1="175" y1="140" x2="175" y2="135" stroke="#FF69B4" strokeWidth={2} />
          <line x1="175" y1="150" x2="175" y2="155" stroke="#FF69B4" strokeWidth={2} />
          <line x1="170" y1="145" x2="165" y2="145" stroke="#FF69B4" strokeWidth={2} />
          <line x1="180" y1="145" x2="185" y2="145" stroke="#FF69B4" strokeWidth={2} />
        </g>

        {/* Hyphen */}
        <rect x="150" y="140" width="50" height="10" fill="#00f0ff" filter="url(#glow)" rx={0} ry={0} style={iconStyle(3)} />
      </svg>

      {/* Brand text */}
      <div
        className={`absolute top-1/2 left-[280px] transform -translate-y-1/2 transition-all duration-1000 ${
          showLogo ? "opacity-100 translate-x-0" : "opacity-0 translate-x-[100px]"
        }`}
      >
        <h1 className="text-5xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent leading-tight">
          hyphenedge
        </h1>
      </div>
    </div>
  );
};

export default AnimatedTriangle;
